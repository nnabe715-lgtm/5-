{% extends 'base.html' %}
{% block content %}
<h2>로그인</h2>
<form id="login-form">
    <div class="mb-3">
        <label>아이디</label>
        <input type="text" id="email" class="form-control" required placeholder="아이디 입력">
    </div>
    <div class="mb-3">
        <label>비밀번호</label>
        <input type="password" id="password" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success">로그인</button>
</form>

<script type="module">
    import { auth } from "/static/firebase.js";
    import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const emailInput = document.getElementById('email').value;
        const passwordInput = document.getElementById('password').value;
        
        const email = emailInput.includes('@') ? emailInput : emailInput + '@school.com';
        const password = passwordInput === '1234' ? '123456' : passwordInput;

        try {
            await signInWithEmailAndPassword(auth, email, password);
            window.location.href = "/";
        } catch (error) {
            alert("로그인 실패: " + error.message);
        }
    });
</script>
{% endblock %}